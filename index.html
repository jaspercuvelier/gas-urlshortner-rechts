<!DOCTYPE html>
<html>

<head>
  <link rel="apple-touch-icon" sizes="180x180" href="images/icons/icon-512x512.png">
  <link rel="icon" type="image/png" sizes="32x32" href="images/icons/icon-72x72.png">
  <link rel="icon" type="image/png" sizes="16x16" href="images/icons/icon-72x72.png">
  <link rel="manifest" href="manifest.json">
  <link rel="mask-icon" href="images/icons/icon-192x192.png" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
  
  <meta name="theme-color" content="#ffffff">
  <title>LINKS@SGFV.BE | Korte links met een lange arm</title>

  <!-- Start Single Page Apps for GitHub Pages -->
  <script type="text/javascript">
    // Single Page Apps for GitHub Pages
    // https://github.com/rafrex/spa-github-pages
    // Copyright (c) 2016 Rafael Pedicini, licensed under the MIT License
    // ----------------------------------------------------------------------
    // This script checks to see if a redirect is present in the query string
    // and converts it back into the correct url and adds it to the
    // browser's history using window.history.replaceState(...),
    // which won't cause the browser to attempt to load the new url.
    // When the single page app is loaded further down in this file,
    // the correct url will be waiting in the browser's history for
    // the single page app to route accordingly.
    (function (l) {
      if (l.search) {
        var q = {};
        l.search.slice(1).split('&').forEach(function (v) {
          var a = v.split('=');
          q[a[0]] = a.slice(1).join('=').replace(/~and~/g, '&');
        });
        if (q.p !== undefined) {
          window.history.replaceState(null, null,
            l.pathname.slice(0, -1) + (q.p || '') +
            (q.q ? ('?' + q.q) : '') +
            l.hash
          );
        }
      }
    }(window.location))
  </script>
  <!-- End Single Page Apps for GitHub Pages -->
  <script>
        addEventListener('DOMContentLoaded', (event) => {
            document.getElementById('finaldestination').style.visibility = "hidden";
      var pathName = window.location.pathname;
      console.log(pathName);




      pathInfo = pathName.replace("/", "");
      if (pathInfo == "" || pathInfo == "takemetothedashboard") {
        var queryURL = "https://script.google.com/macros/s/AKfycbw33alrs678lJrYrS1P9xPW2Zza4TVn606JXQL8FGkBuooD9AC107ZG3tGJ87-Gc5Ad/exec?takemetothedashboard"

        try {
          document.getElementById('finaldestination').style.visibility = "visible"; 
          document.getElementById('finaldestination').href = queryURL
          window.open(queryURL, '_top')
        }
        catch (err) {
          var ok = confirm("Hmmm... Ik neem je mee naar het dashboard.")
          if (ok) { window.open(queryURL, '_top') }

        }

      }
      else {

        queryURL = "https://script.google.com/macros/s/AKfycbw33alrs678lJrYrS1P9xPW2Zza4TVn606JXQL8FGkBuooD9AC107ZG3tGJ87-Gc5Ad/exec?" + pathInfo;
        fetch(queryURL, { redirect: "follow", method: "GET", headers: { "Content-Type": "text/plain;charset=utf-8", } })
          .then((response) => response.json())
          .then((data) => {
            console.log('REDIRECT RETURNED');
            console.log(data)
            console.log('url:' + data.redirectURL);
            document.getElementById('finaldestination').style.visibility = "visible";
            document.getElementById('finaldestination').href = data.redirectURL


            try {
              window.open(data.redirectURL, '_top')
            }
            catch (err) {
              console.log('Link kan niet geopend worden... :-(')
              console.log(err)
              document.getElementById('finaldestination').style.visibility = "visible";
              document.getElementById('finaldestination').href = data.redirectURL
            }


          })




      }



    })
  </script>

</head>
<body class="vw-100 vh-100 ">
    <div class="container-fluid w-100 bg-light p-3 h-100 d-flex flex-column justify-content-between align-items-center">
        <h1 class="display-3">links.sgfv.be</h1>
        <div class="card text-center text-dark bg-light mb-3 shadow w-75">
            <div class="card-header">
                <h3>Even geduld...</h3>
              </div>
            <img src="https://media0.giphy.com/media/pFZTlrO0MV6LoWSDXd/giphy.gif?cid=5a38a5a23aw7ba2duzvty9teyva5tqo6elod5cjvc73bzb20&amp;rid=giphy.gif&amp;ct=g"
               alt="Even geduld">
            <div class="card-body">
                <h4 class="card-title">U wordt omgeleid naar de juiste pagina...</h4>
                <a id="finaldestination" href="" class="btn btn-primary" target="_top">Klik hier om de omleiding manueel te starten</a>
            </div>
        </div>
        <img src="https://storage.googleapis.com/handige-snelle-downloads/logo/SGFV-logo.png" class="img-fluid"
            alt="Logo sgfv">
            <code style="position:absolute; bottom:0px">V1.0</code>
    </div>

  <script>
    /*
    // Check compatibility for the browser we're running this in
if ("serviceWorker" in navigator) {
  if (navigator.serviceWorker.controller) {
    // Optionally log to console "Service Worker found no need to register."
  } else {
    // Register the service worker
    navigator.serviceWorker
      .register("sw.js", {
        scope: "./"
      })
      .then(function (reg) {
        // Optionally log to console "Service worker registered."
      });
  }
}*/
  </script>
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>

</body>

</html>
